---
date: '2025-08-15'
permalink: https://github.com/MicrosoftDocs/azure-ai-docs/compare/MicrosoftDocs:a697dec...MicrosoftDocs:e5828c1
summary: このコード差分では、主に画像ファイルのメタデータが更新され、文書の整合性が保たれました。Markdownファイルにはテキスト修正と構成の見直しが行われています。新機能や重大な変更はありませんが、ユーザーの理解を助けるために情報が整理されており、特に技術的知識がないユーザーでもアクセスしやすくなっています。全体として、この更新によりユーザーエクスペリエンスが向上し、文書の信頼性が強化されています。
title: Diff Insight Report - search

---

[View Diff on GitHub](https://github.com/MicrosoftDocs/azure-ai-docs/compare/MicrosoftDocs:a697dec...MicrosoftDocs:e5828c1){target="_blank"}

<format>
# Highlights
このコード差分では、主要な変更は画像ファイルの更新に見られ、具体的な内容変更は少ないものの、ドキュメントの整合性を保つためにメタデータの更新が行われました。また、Markdownファイルにはテキストの修正および若干の再構成が加えられています。

## New features
- なし

## Breaking changes
- なし

## Other updates
- 複数の画像ファイル (`aad-app-authentication-configuration.png`, `aad-app-grant-admin-consent.png`, `application-api-permissions.png`, `application-client-secret-copy.png`, `delegated-api-permissions.png`) のメタデータ更新。
- `search-howto-index-sharepoint-online.md` での文書明確化とリンクの整備および日付などの更新。

# Insights
今回のコード差分では、画像ファイルに対する更新がおそらくファイルのデジタル管理の側面を改善し、将来的な利用や管理を容易にするために行われた可能性があります。これにより、ドキュメントそのものの信頼性や一貫性が向上しています。

画像ファイルの実体には変更がなかったため、一般ユーザーには目に見える影響はありませんが、開発者やシステム管理者にとっては管理やバージョン管理が容易になるでしょう。

また、Markdownファイルの更新では、ユーザーの理解を容易にするための文書修正やリンクの見直しが行われ、ソフトウェアやライブラリに関する情報が追加されました。これにより、ドキュメントの実用性が向上し、特に技術的な背景を持たないユーザーでも、情報に簡単にアクセスできるようになっています。全体としては、ユーザーエクスペリエンス向上と情報伝達の円滑化に貢献している更新と言えるでしょう。
</format>

# Summary Table
|  Filename  | Type |    Title    | Status | A  | D  | M  |
|------------|------|-------------|--------|----|----|----|
| [aad-app-authentication-configuration.png](#item-56d8b1) | minor update | 画像ファイルの更新 | modified | 0 | 0 | 0 | 
| [aad-app-grant-admin-consent.png](#item-818345) | minor update | 画像ファイルの更新 | modified | 0 | 0 | 0 | 
| [application-api-permissions.png](#item-8199de) | minor update | 画像ファイルの更新 | modified | 0 | 0 | 0 | 
| [application-client-secret-copy.png](#item-46de27) | minor update | 画像ファイルの更新 | modified | 0 | 0 | 0 | 
| [delegated-api-permissions.png](#item-9ba39b) | minor update | 画像ファイルの更新 | modified | 0 | 0 | 0 | 
| [search-howto-index-sharepoint-online.md](#item-49ff6e) | minor update | ドキュメントの内容更新 | modified | 37 | 39 | 76 | 


# Modified Contents
## articles/search/media/search-howto-index-sharepoint-online/aad-app-authentication-configuration.png{#item-56d8b1}

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "画像ファイルの更新"
}
```

### Explanation
この変更は、`aad-app-authentication-configuration.png`という名前の画像ファイルに対するもので、ファイルの内容に変更はなく、追加や削除も行われていません。ファイルは修正されたが、具体的な変更の内容はなく、ファイルのメタデータや関連リンクの情報が更新された可能性があります。この更新は、ドキュメントの他の部分との整合性を保つために行われたと考えられます。

## articles/search/media/search-howto-index-sharepoint-online/aad-app-grant-admin-consent.png{#item-818345}

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "画像ファイルの更新"
}
```

### Explanation
この変更は、`aad-app-grant-admin-consent.png`という画像ファイルに対するもので、ファイルの内容に実質的な変更はありませんが、ファイル自体のメタデータが更新された可能性があります。具体的には、ファイルの追加や削除は行われておらず、変更点もありません。この更新は、ドキュメントの整合性を保つためのものであると考えられます。更新されたファイルへのリンクも提供されており、ユーザーは最新の状態でアクセスすることができます。

## articles/search/media/search-howto-index-sharepoint-online/application-api-permissions.png{#item-8199de}

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "画像ファイルの更新"
}
```

### Explanation
この変更は、`application-api-permissions.png`という画像ファイルに関するものであり、ファイル自体の内容、追加、削除は行われていません。したがって、変更点は実質的には存在しないものの、ファイルのメタデータやバージョン管理においては更新が行われた可能性があります。この更新は、ドキュメント全体の整合性を持たせるために行われることが一般的です。更新された画像ファイルへのリンクも提供されているため、ユーザーは最新の情報を容易に確認することができます。

## articles/search/media/search-howto-index-sharepoint-online/application-client-secret-copy.png{#item-46de27}

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "画像ファイルの更新"
}
```

### Explanation
この変更は、`application-client-secret-copy.png`という画像ファイルに関するものであり、ファイルの実体には変更が加えられていません。具体的には、追加や削除、内容の変更は一切行われていませんが、ファイルのメタデータやバージョニングが更新されることがあります。このような更新は、ドキュメントの整合性を保つために行われることが一般的です。また、更新された画像ファイルへのリンクが提供されており、ユーザーは最新の状態を簡単に確認できます。

## articles/search/media/search-howto-index-sharepoint-online/delegated-api-permissions.png{#item-9ba39b}

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "画像ファイルの更新"
}
```

### Explanation
この変更は、`delegated-api-permissions.png`という画像ファイルに関連しています。このファイルには内容の追加や削除は行われておらず、実際の変更はありませんが、画像ファイルのメタデータやその管理において更新があった可能性があります。今回の変更により、ドキュメントにおける整合性が保たれ、最新の情報が提供されることが期待されます。また、更新された画像ファイルへのアクセス用のリンクも用意されており、ユーザーは最新情報に簡単にアクセスできます。

## articles/search/search-howto-index-sharepoint-online.md{#item-49ff6e}

<details>
<summary>Diff</summary>
````diff
@@ -6,7 +6,7 @@ author: gmndrg
 ms.author: gimondra
 ms.service: azure-ai-search
 ms.topic: how-to
-ms.date: 06/17/2025
+ms.date: 08/13/2025
 ms.custom:
   - ignite-2023
   - sfi-image-nochange
@@ -22,14 +22,14 @@ ms.custom:
 >
 > [Fill out this form](https://aka.ms/azure-cognitive-search/indexer-preview) to register for the preview. All requests are approved automatically. After you fill out the form, use a [preview REST API](search-api-preview.md) to index your content. 
 
-This article explains how to configure a [search indexer](search-indexer-overview.md) to index documents stored in SharePoint document libraries for full text search in Azure AI Search. Configuration steps are first, followed by behaviors and scenarios
+This article explains how to configure a [search indexer](search-indexer-overview.md) to index documents stored in SharePoint document libraries for full text search in Azure AI Search. Configuration steps are first, followed by behaviors and scenarios.
 
-In Azure AI Search, an indexer extracts searchable data and metadata from a data source. The SharePoint Online indexer connects to your SharePoint site and indexes documents from one or more document libraries. The indexer provides the following functionality:
+In Azure AI Search, an indexer extracts searchable data and metadata from a data source. The SharePoint Online indexer provides the following functionality:
 
 + Indexes files and metadata from one or more document libraries.
 + Indexes incrementally, picking up just the new and changed files and metadata. 
 + Detects deleted content automatically. Document deletion in the library is picked up on the next indexer run, and the corresponding search document is removed from the index.
-+ Extracts text and normalized images from indexed documents automatically. Optionally, you can add a [skillset](cognitive-search-working-with-skillsets.md) for deeper [AI enrichment](cognitive-search-concept-intro.md), like OCR or text translation. 
++ Extracts text and normalized images from indexed documents automatically. Optionally, you can add a [skillset](cognitive-search-working-with-skillsets.md) for deeper [AI enrichment](cognitive-search-concept-intro.md), like OCR or entity recognition. 
 
 ## Prerequisites
 
@@ -39,6 +39,8 @@ In Azure AI Search, an indexer extracts searchable data and metadata from a data
 
 + Files in a [document library](https://support.microsoft.com/office/what-is-a-document-library-3b5976dd-65cf-4c9e-bf5a-713c10ca2872).
 
++ [Visual Studio Code](https://code.visualstudio.com/download) with the [REST Client extension](https://marketplace.visualstudio.com/items?itemName=humao.rest-client) for setting up and running the indexer pipeline.
+
 ## Supported document formats
 
 The SharePoint Online indexer can extract text from the following document formats:
@@ -73,9 +75,9 @@ Here are some considerations when using this feature:
 
 + If you still need a custom SharePoint Online content indexing solution using Azure AI Search in a production environment, despite the recommendation to use Microsoft Copilot Studio, consider:
 
-  - Creating a custom connector with [SharePoint Webhooks](/sharepoint/dev/apis/webhooks/overview-sharepoint-webhooks), calling [Microsoft Graph API](/graph/use-the-api) to export the data to an Azure Blob container, and then use the [Azure blob indexer](search-howto-indexing-azure-blob-storage.md) for incremental indexing.
+  + Creating a custom connector with [SharePoint Webhooks](/sharepoint/dev/apis/webhooks/overview-sharepoint-webhooks), calling [Microsoft Graph API](/graph/use-the-api) to export the data to an Azure Blob container, and then use the [Azure blob indexer](search-howto-indexing-azure-blob-storage.md) for incremental indexing.
 
-  - Creating your own [Azure Logic Apps workflow](/azure/logic-apps/logic-apps-overview) using [Azure Logic Apps SharePoint connector](/connectors/sharepointonline/) and [Azure AI Search connector](/connectors/azureaisearch/) when reaching General Availability. You can use the workflow generated by the [Azure portal wizard](search-how-to-index-logic-apps-indexers.md) as a starting point and then customize it in the [Azure Logic Apps designer](/azure/logic-apps/quickstart-create-example-consumption-workflow#add-the-trigger) to include the transformation steps you need. The Azure Logic App workflow created when using the [Azure AI Search wizard](search-how-to-index-logic-apps-indexers.md) to index SharePoint Online data is a [consumption workflow](/azure/logic-apps/logic-apps-overview#key-terms). If you're setting up production workloads, make sure to switch to a [standard logic app workflow](/azure/logic-apps/logic-apps-overview#key-terms) and take advantage of its additional enterprise features.
+  + Creating your own [Azure Logic Apps workflow](/azure/logic-apps/logic-apps-overview) using [Azure Logic Apps SharePoint connector](/connectors/sharepointonline/) and [Azure AI Search connector](/connectors/azureaisearch/) when reaching General Availability. You can use the workflow generated by the [Azure portal wizard](search-how-to-index-logic-apps-indexers.md) as a starting point and then customize it in the [Azure Logic Apps designer](/azure/logic-apps/quickstart-create-example-consumption-workflow#add-the-trigger) to include the transformation steps you need. The Azure Logic App workflow created when using the [Azure AI Search wizard](search-how-to-index-logic-apps-indexers.md) to index SharePoint Online data is a [consumption workflow](/azure/logic-apps/logic-apps-overview#key-terms). If you're setting up production workloads, make sure to switch to a [standard logic app workflow](/azure/logic-apps/logic-apps-overview#key-terms) and take advantage of its additional enterprise features.
   
   Regardless of the approach you choose, whether building a custom connector with SharePoint hooks or creating an Azure Logic Apps workflow, be sure to implement robust security measures. These measures include configuring shared private links, setting up firewalls, preserving user permissions from the source and honor those permissions at query time, among others. You should also regularly audit and monitor your pipeline.
 
@@ -123,58 +125,53 @@ The SharePoint Online indexer uses a Microsoft Entra application for authenticat
 
 1. On the navigation pane under **Manage**, select **API permissions**, then **Add a permission**, then **Microsoft Graph**.
 
-    + If the indexer is using application API permissions, then select **Application permissions** and add the following:
+    + If the indexer is using application API permissions, select **Application permissions**, and then select **Application.Read.All**.
+
+      :::image type="content" source="media/search-howto-index-sharepoint-online/application-api-permissions.png" alt-text="Screenshot of application API permissions." lightbox="media/search-howto-index-sharepoint-online/application-api-permissions.png":::
 
-        + **Application - Files.Read.All**
-        + **Application - Sites.Read.All**
-        
-        :::image type="content" source="media/search-howto-index-sharepoint-online/application-api-permissions.png" alt-text="Screenshot of application API permissions.":::
-        
-        Using application permissions means that the indexer accesses the SharePoint site in a service context. So when you run the indexer it will have access to all content in the SharePoint tenant, which requires tenant admin approval. A client secret is also required for authentication. Setting up the client secret is described later in this article.
+      Using application permissions means that the indexer accesses the SharePoint site in a service context. So when you run the indexer, it has access to all content in the SharePoint tenant, which requires tenant admin approval. A client secret is also required for authentication. Setting up the client secret is described later in this article.
 
-    + If the indexer is using delegated API permissions, select **Delegated permissions** and add the following:
+    + If the indexer is using delegated API permissions, select **Delegated permissions** and then select  **Application.Read.All**.
 
-        + **Delegated - Files.Read.All**
-        + **Delegated - Sites.Read.All**
-        + **Delegated - User.Read**
-        
-        :::image type="content" source="media/search-howto-index-sharepoint-online/delegated-api-permissions.png" alt-text="Screenshot showing delegated API permissions.":::
-        
-        Delegated permissions allow the search client to connect to SharePoint under the security identity of the current user.
+      :::image type="content" source="media/search-howto-index-sharepoint-online/delegated-api-permissions.png" alt-text="Screenshot showing delegated API permissions." lightbox="media/search-howto-index-sharepoint-online/delegated-api-permissions.png":::
+
+      Delegated permissions allow the search client to connect to SharePoint under the security identity of the current user.
 
 1. Give admin consent.
 
     Tenant admin consent is required when using application API permissions. Some tenants are locked down in such a way that tenant admin consent is required for delegated API permissions as well. If either of these conditions apply, you’ll need to have a tenant admin grant consent for this Microsoft Entra application before creating the indexer.
 
-    :::image type="content" source="media/search-howto-index-sharepoint-online/aad-app-grant-admin-consent.png" alt-text="Screenshot showing Microsoft Entra app grant admin consent.":::
+    :::image type="content" source="media/search-howto-index-sharepoint-online/aad-app-grant-admin-consent.png" alt-text="Screenshot showing Microsoft Entra app grant admin consent." lightbox="media/search-howto-index-sharepoint-online/aad-app-grant-admin-consent.png":::
+
+1. From the menu, select **Authentication (Preview)**.
 
-1. Select the **Authentication** tab. 
+1. On the **Redirect URI configuration** tab, select **+ Add Redirect URI**, then **Mobile and desktop applications**, then check `https://login.microsoftonline.com/common/oauth2/nativeclient`, then **Configure**.
 
-1. Set **Allow public client flows** to **Yes** then select **Save**.
+    :::image type="content" source="media/search-howto-index-sharepoint-online/aad-app-authentication-configuration.png" alt-text="Screenshot showing Microsoft Entra app authentication configuration." lightbox="media/search-howto-index-sharepoint-online/aad-app-authentication-configuration.png" :::
 
-1. Select **+ Add a platform**, then **Mobile and desktop applications**, then check `https://login.microsoftonline.com/common/oauth2/nativeclient`, then **Configure**.
+1. Select the **Settings** tab. 
 
-    :::image type="content" source="media/search-howto-index-sharepoint-online/aad-app-authentication-configuration.png" alt-text="Screenshot showing Microsoft Entra app authentication configuration.":::
+1. Enable **Allow public client flows**. Save your changes.
 
 1. (Application API Permissions only) To authenticate to the Microsoft Entra application using application permissions, the indexer requires a client secret.
 
-    + Select **Certificates & Secrets** from the menu on the left, then **Client secrets**, then **New client secret**.
-    
-        :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret.png" alt-text="Screenshot showing new client secret.":::
-    
+    + From the menu, select **Certificates & Secrets**, then **Client secrets**, then **New client secret**.
+
+      :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret.png" alt-text="Screenshot showing new client secret." lightbox="media/search-howto-index-sharepoint-online/application-client-secret.png" :::
+
     + In the menu that pops up, enter a description for the new client secret. Adjust the expiration date if necessary. If the secret expires, it needs to be recreated and the indexer needs to be updated with the new secret.
-    
-        :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret-setup.png" alt-text="Screenshot showing how to set up a client secret.":::
-    
-    + The new client secret appears in the secret list. Once you navigate away from the page, the secret is no longer be visible, so copy it using the copy button and save it in a secure location.
-    
-        :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret-copy.png" alt-text="Screenshot showing where to copy a client secret.":::
+
+      :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret-setup.png" alt-text="Screenshot showing how to set up a client secret." lightbox="media/search-howto-index-sharepoint-online/application-client-secret-setup.png":::
+
+    + The new client secret appears in the secret list. Once you navigate away from the page, the secret is no longer be visible, so copy the value using the copy button and save it in a secure location.
+
+      :::image type="content" source="media/search-howto-index-sharepoint-online/application-client-secret-copy.png" alt-text="Screenshot showing where to copy a client secret.":::
 
 <a name="create-data-source"></a>
 
 ### Step 4: Create data source
 
-Starting in this section, use a preview REST API for the remaining steps. We recommend the latest preview API.
+Starting in this section, use a preview REST API and a REST client for the remaining steps. We recommend the latest preview API.
 
 A data source specifies which data to index, credentials, and policies to efficiently identify changes in the data (new, modified, or deleted rows). A data source can be used by multiple indexers in the same search service.
 
@@ -202,7 +199,7 @@ api-key: [admin key]
 
 #### Connection string format
 
-The format of the connection string changes based on whether the indexer is using delegated API permissions or application API permissions
+The format of the connection string changes based on whether the indexer is using delegated API permissions or application API permissions.
 
 + Delegated API permissions connection string format
 
@@ -212,6 +209,8 @@ The format of the connection string changes based on whether the indexer is usin
 
     `SharePointOnlineEndpoint=[SharePoint site url];ApplicationId=[Azure AD App ID];ApplicationSecret=[Azure AD App client secret];TenantId=[SharePoint site tenant id]`
 
+You can get tenant ID from the overview page in the Microsoft Entra admin center in your M365 subscription.
+
 > [!NOTE]
 > If the SharePoint site is in the same tenant as the search service and system-assigned managed identity is enabled, `TenantId` doesn't have to be included in the connection string. If the SharePoint site is in a different tenant from the search service, `TenantId` must be included.
 
@@ -267,7 +266,6 @@ There are a few steps to creating the indexer:
         "batchSize": null,
         "maxFailedItems": null,
         "maxFailedItemsPerBatch": null,
-        "base64EncodeKeys": null,
         "configuration": {
             "indexedFileNameExtensions" : ".pdf, .docx",
             "excludedFileNameExtensions" : ".png, .jpg",
````
</details>

### Summary

```json
{
    "modification_type": "minor update",
    "modification_title": "ドキュメントの内容更新"
}
```

### Explanation
この変更は、`search-howto-index-sharepoint-online.md`というMarkdownファイルの更新に関連しています。全体で37行の追加と39行の削除があり、主にテキストの明確化や修正が行われています。具体的な変更点としては、日付の更新、文章の文法修正、リンクの整備などが含まれます。また、新たに必要なソフトウェアやライブラリに関する情報が追加され、動作環境についても触れられています。これらの変更により、ドキュメントの正確性とユーザーにとっての有用性が向上しています。更新された内容はGitHub上で確認可能で、リンクも提供されているため、ユーザーは最新の情報にアクセスしやすくなっています。


